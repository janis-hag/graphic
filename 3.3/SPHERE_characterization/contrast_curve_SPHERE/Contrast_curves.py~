# -*- coding: utf-8 -*-
import sys
sys.path.insert(0, '/home/spectro/peretti/GRAPHIC/version_seb/SPHERE_characterization/')
sys.path.insert(0, '/home/spectro/peretti/GRAPHIC/version_seb/SPHERE_characterization/photometry_SPHERE')

import graphic_contrast_adi
reload(graphic_contrast_adi)
from graphic_contrast_adi import *
import contrast_curve_sdi
reload(contrast_curve_sdi)
from contrast_curve_sdi import *
import signal_to_noise
reload(signal_to_noise)
from signal_to_noise import *
import comp_detection
reload(comp_detection)
from comp_detection import *
import companion_extraction
reload(companion_extraction)
from companion_extraction import *
import SPHERE_psf_combine
reload(SPHERE_psf_combine)
from SPHERE_psf_combine import *
import adi_self_subtraction_computation 
reload(adi_self_subtraction_computation)
from adi_self_subtraction_computation import *
import primary_flux 
reload(primary_flux)
from primary_flux import *

##########################
#Settings
##########################
target_name="HD4113"
#wdir='/Users/sebastien/Desktop/HD4113/'
wdir='./'
path_results=wdir+"Contrast_curve_resulting_files/"
#image_filename='nomask_final_image_HD_4113_DB_H23_ps_3.3.0_nc_1450.0_3.5_0.3_30.0_1200.0_sdi_cl_nomed_SPHER_2016-07-20T08_21_59_475_SCIENCE.fits'
#image_filename='nomask_final_image_HD_4113_DB_H23_ps_3.3.0_nc_1450.0_3.5_0.3_30.0_1200.0_right_cl_nomed_SPHER_2016-07-20T08_21_59_475_SCIENCE.fits'
image_filename='nomask_final_image_HD_219077_DB_H23_ps_3.3.0_nc_1232.0_3.5_0.3_30.0_1200.0_left_cl_nomed_SPHER.2016-07-19T07_27_10.652IRD_SCIENCE_DBI_RAW.fits'
#image_filename_FP="nomask_final_image_HD_4113_DB_H23_ps_3.3.0_nc_1450.0_3.5_0.3_30.0_1200.0_FP_3.3.0_s_0.1_3_dm_10_16_left_cl_nomed_SPHER_2016-07-20T08_21_59_475_SCIENCE.fits"
pattern_psf_l="left*FLUX"
pattern_psf_r="right*FLUX"
age='5.000'
sep_FP=np.array([0.3,0.4,0.5,0.7,1.,1.5,2.,3.])
platescale=0.01226

import os
try:
    os.stat(path_results)
except:
    os.mkdir(path_results)

##########################
#routines
##########################
print "\nStart of psf combine\n"
psf_combine(wdir,pattern_psf_l,pattern_psf_r)

print "\nStart of psf primary flux determination\n"
primary_flux(wdir,path_results,image_filename)

"""print "\nStart of companion detection\n"
comp_detection(wdir,image_filename)
print "\nStart of ADI self subtraction\n"
adi_self_subtraction_computation(wdir,image_filename_FP,sep_FP)
print "\nStart of astrometry and photometry companion extraction\n"
companion_extraction(wdir,path_results,image_filename,target_name)
print "\nStart of Signal to noise computation\n"
signal_to_noise(wdir,path_results,image_filename,target_name,platescale)

print "\nStart of ADI contrast curve computation\n"
graphic_contrast_adi(target_name,wdir,path_results,image_filename)
print "\nStart of SDI contrast curve computation\n"
contrast_curve_sdi(target_name,wdir,age)"""


